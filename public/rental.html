<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>흥덕청소년 문화의집 - 시설 이용</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script type="module" src="firebase-config.js"></script>
</head>
<body>
    <div class="rental-wrapper">
        <div class="rental-container">
            <img src="hd.JPG" alt="흥덕청소년 문화의집 건물" class="main-building-img" style="display:block; max-width:700px; width:90vw; margin:32px auto 0 auto; border-radius:28px; box-shadow:0 4px 24px #e0e7ef22;">
            <!-- 시설 이용 신청 카드 -->
            <div class="main-card" style="background:#fff; border-radius:28px; box-shadow:0 4px 24px #e0e7ef22; max-width:700px; width:90vw; margin:32px auto 0 auto; padding:32px 16px 24px 16px; text-align:center;">
                <h1 class="main-page-title" style="font-size:1.47rem; font-weight:800; color:#222; margin-bottom:8px;">시설 이용 신청</h1>
                <div class="main-page-desc" style="font-size:1.12rem; color:#555; text-align:center; margin-bottom:21px;">이용자 정보를 입력해주세요</div>
            </div>
            <!-- 입력폼 카드(제목/설명 포함) -->
            <div class="main-card" style="background:#fff; border-radius:28px; box-shadow:0 4px 24px #e0e7ef22; max-width:700px; margin:32px auto 0 auto; padding:32px 24px 28px 24px; text-align:center;">
                <h2 style="font-size:1.5rem; font-weight:800; color:#e74c3c; margin-bottom:7px;">기본정보 입력</h2>
                <div style="font-size:1.12rem; color:#555; text-align:center; margin-bottom:21px;">이용자 정보를 정확히 입력해 주세요.</div>
                <form class="rental-form-centered">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:32px 32px; margin-bottom:32px;">
                        <div style="text-align:left;">
                            <label for="user-name" style="font-weight:700; font-size:1.2rem; color:#222; margin-bottom:8px; display:block;">성명</label>
                            <input type="text" id="user-name" name="user-name" placeholder="이름을 입력하세요" required style="width:100%; padding:16px 20px; border:2px solid #e0e7ef; border-radius:16px; font-size:1.12rem; font-weight:600; color:#222; background:#fff;">
                        </div>
                        <div style="text-align:left;">
                            <label for="user-age" style="font-weight:700; font-size:1.2rem; color:#222; margin-bottom:8px; display:block;">나이</label>
                            <select id="user-age" name="user-age" required style="width:100%; padding:16px 20px; border:2px solid #e0e7ef; border-radius:16px; font-size:1.12rem; font-weight:600; color:#222; background:#fff;">
                                <option value="">선택</option>
                                <option value="유아">유아</option>
                                <option value="초등">초등</option>
                                <option value="중등">중등</option>
                                <option value="고등">고등</option>
                                <option value="대학생(24세이하)">대학생(24세이하)</option>
                                <option value="성인">성인</option>
                            </select>
                        </div>
                        <div style="text-align:left;">
                            <label for="user-gender" style="font-weight:700; font-size:1.2rem; color:#222; margin-bottom:8px; display:block;">성별</label>
                            <select id="user-gender" name="user-gender" required style="width:100%; padding:16px 20px; border:2px solid #e0e7ef; border-radius:16px; font-size:1.12rem; font-weight:600; color:#222; background:#fff;">
                                <option value="">선택</option>
                                <option value="남">남</option>
                                <option value="여">여</option>
                            </select>
                        </div>
                        <div style="text-align:left;">
                            <label for="user-phone" style="font-weight:700; font-size:1.2rem; color:#222; margin-bottom:8px; display:block;">핸드폰번호 끝 4자리</label>
                            <input type="tel" id="user-phone" name="user-phone" placeholder="예: 1234" maxlength="4" required style="width:100%; padding:16px 20px; border:2px solid #e0e7ef; border-radius:16px; font-size:1.12rem; font-weight:600; color:#222; background:#fff;">
                        </div>
                    </div>
                    <div style="display:flex; gap:24px; margin-top:8px;">
                        <button type="button" onclick="history.back()" style="flex:1; padding:16px 0; border-radius:16px; background:linear-gradient(90deg,#a8edea 0%,#fed6e3 100%); border:none; font-weight:700; font-size:1.15rem; color:#222; cursor:pointer;">◀ 이전</button>
                        <button type="submit" style="flex:1; padding:16px 0; border-radius:16px; background:linear-gradient(90deg,#fbc2eb 0%,#a6c1ee 100%); border:none; font-weight:700; font-size:1.15rem; color:#222; cursor:pointer;">다음 ▶</button>
                    </div>
                </form>
            </div>

            <div id="notification" class="notification"></div>
        </div>
    </div>

    <script>
        // 폼 제출 처리
        document.querySelector('.rental-form-centered').addEventListener('submit', function(e) {
            e.preventDefault();
            const userPhone = document.getElementById('user-phone').value;
            if (!/^\d{4}$/.test(userPhone)) {
                showPhoneErrorModal();
                document.getElementById('user-phone').focus();
                return;
            }
            const userName = document.getElementById('user-name').value;
            if (userName) {
                localStorage.setItem('userName', userName);
            }
            if (userPhone) {
                localStorage.setItem('userPhone', userPhone);
            }
            window.location.href = 'select-facility.html';
        });

        // 전화번호 자동 포맷팅
        document.getElementById('user-phone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/[^0-9]/g, '');
            if (value.length > 4) value = value.slice(0, 4);
            e.target.value = value;
        });

        // 커스텀 모달 함수
        function showModal(msg) {
            let modal = document.createElement('div');
            modal.style.position = 'fixed';
            modal.style.left = 0;
            modal.style.top = 0;
            modal.style.width = '100vw';
            modal.style.height = '100vh';
            modal.style.background = 'rgba(0,0,0,0.35)';
            modal.style.display = 'flex';
            modal.style.alignItems = 'center';
            modal.style.justifyContent = 'center';
            modal.style.zIndex = 9999;
            modal.innerHTML = `
                <div style="background:#fff;padding:32px 28px;border-radius:18px;box-shadow:0 4px 24px #e74c3c22;font-size:1.15rem;font-weight:600;color:#e74c3c;text-align:center;min-width:220px;max-width:90vw;">
                    ${msg}<br><br>
                    <button style='margin-top:18px;padding:10px 28px;border-radius:12px;background:linear-gradient(90deg,#e74c3c,#c0392b);border:none;font-weight:700;font-size:1.08rem;color:#fff;cursor:pointer;' onclick='this.parentElement.parentElement.remove()'>확인</button>
                </div>
            `;
            document.body.appendChild(modal);
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // 개인정보 동의 모달 생성 함수 (index.html과 동일)
        function showAgreementModal(onAgree, onCancel) {
            if (document.getElementById('agreement-modal')) return;
            const modal = document.createElement('div');
            modal.id = 'agreement-modal';
            modal.style.position = 'fixed';
            modal.style.left = 0;
            modal.style.top = 0;
            modal.style.width = '100vw';
            modal.style.height = '100vh';
            modal.style.background = 'rgba(0,0,0,0.35)';
            modal.style.display = 'flex';
            modal.style.alignItems = 'center';
            modal.style.justifyContent = 'center';
            modal.style.zIndex = 9999;
            modal.innerHTML = `
              <div style="background:#fff;max-width:350px;width:92vw;min-width:0;border-radius:14px;box-shadow:0 4px 24px #e74c3c33;font-size:0.97rem;font-weight:500;color:#222;text-align:left;overflow:hidden;display:flex;flex-direction:column;">
                <div style="background:linear-gradient(90deg,#fbc2eb 0%,#a6c1ee 100%);padding:14px 0 10px 0;text-align:center;">
                  <span style="font-size:1.08rem;font-weight:700;color:#e74c3c;letter-spacing:-1px;">개인정보 동의</span>
                </div>
                <div style="flex:1;max-height:220px;overflow-y:auto;padding:14px 14px 0 14px;">
                  <div style="margin-bottom:10px;line-height:1.5;font-size:0.97rem;">
                    <span style="font-weight:600;">흥덕청소년문화의집</span>은 개인정보보호법 등 관련법령에 따라 아래와 같이 개인정보를 수집·이용 및 제3자 제공하고자 합니다.<br><br>
                    <b style="color:#3498db;">□ 개인정보 수집‧이용 내역</b><br>
                    <span style="color:#555;">항목</span>: 성명, 성별, 나이, 전화번호<br>
                    <span style="color:#555;">수집목적</span>: 이용현황 통계 작성<br>
                    <span style="color:#555;">보유기간</span>: 3년<br>
                    <span style="color:#888;font-size:0.89em;display:block;margin-top:2px;">※ 위의 개인정보 수집‧이용에 대한 동의를 거부할 권리가 있습니다.<br>그러나 동의를 거부할 경우 사업 참여가 제한될 수 있습니다.</span>
                    <div style="margin-top:8px;display:flex;gap:14px;align-items:center;">
                      <label style="display:flex;align-items:center;gap:4px;cursor:pointer;font-size:0.97rem;font-weight:700;color:#e74c3c;"><input type="radio" name="agree1" value="yes" style="appearance:none;width:15px;height:15px;border:2px solid #e0e7ef;border-radius:50%;outline:none;margin-right:2px;background:#fff;vertical-align:middle;"> 동의</label>
                      <label style="display:flex;align-items:center;gap:4px;cursor:pointer;font-size:0.97rem;font-weight:700;color:#636e72;"><input type="radio" name="agree1" value="no" style="appearance:none;width:15px;height:15px;border:2px solid #e0e7ef;border-radius:50%;outline:none;margin-right:2px;background:#fff;vertical-align:middle;"> 미동의</label>
                    </div>
                  </div>
                  <div style="margin-bottom:10px;line-height:1.5;font-size:0.97rem;">
                    <b style="color:#3498db;">□ 개인정보 제3자 제공 내역</b><br>
                    <span style="color:#555;">제공받는 기관</span>: 용인시청소년미래재단, 지자체, 관련 업무 상위 기관 ·부서<br>
                    <span style="color:#555;">제공목적</span>: 시설 이용 현황<br>
                    <span style="color:#555;">제공하는 항목</span>: 성명, 성별, 나이, 전화번호<br>
                    <span style="color:#555;">보유기간</span>: 3년<br>
                    <span style="color:#888;font-size:0.89em;display:block;margin-top:2px;">※ 위의 개인정보 제공에 대한 동의를 거부할 권리가 있습니다.<br>그러나 동의를 거부할 경우 사업 참여 및 중요사항 전달에 제한을 받을 수 있습니다.<br>위와 같이 개인정보를 제3자 제공하는데 동의하십니까?</span>
                    <div style="margin-top:8px;display:flex;gap:14px;align-items:center;">
                      <label style="display:flex;align-items:center;gap:4px;cursor:pointer;font-size:0.97rem;font-weight:700;color:#e74c3c;"><input type="radio" name="agree2" value="yes" style="appearance:none;width:15px;height:15px;border:2px solid #e0e7ef;border-radius:50%;outline:none;margin-right:2px;background:#fff;vertical-align:middle;"> 동의</label>
                      <label style="display:flex;align-items:center;gap:4px;cursor:pointer;font-size:0.97rem;font-weight:700;color:#636e72;"><input type="radio" name="agree2" value="no" style="appearance:none;width:15px;height:15px;border:2px solid #e0e7ef;border-radius:50%;outline:none;margin-right:2px;background:#fff;vertical-align:middle;"> 미동의</label>
                    </div>
                  </div>
                </div>
                <div style="padding:10px 14px 14px 14px;display:flex;gap:10px;justify-content:center;background:#fff;box-shadow:0 -2px 8px #e0e7ef22;">
                  <button id="agreement-confirm" style="padding:8px 0;width:80px;border-radius:10px;background:linear-gradient(90deg,#e74c3c,#c0392b);border:none;font-weight:700;font-size:1.01rem;color:#fff;cursor:pointer;">확인</button>
                  <button id="agreement-cancel" style="padding:8px 0;width:80px;border-radius:10px;background:linear-gradient(90deg,#e0e7ef,#fed6e3);color:#222;border:none;font-weight:700;font-size:1.01rem;cursor:pointer;">취소</button>
                </div>
              </div>
            `;
            document.body.appendChild(modal);
            document.getElementById('agreement-confirm').onclick = function() {
              const agree1 = document.querySelector('input[name="agree1"]:checked');
              const agree2 = document.querySelector('input[name="agree2"]:checked');
              if (!agree1 || !agree2 || agree1.value !== 'yes' || agree2.value !== 'yes') {
                alert('개인정보 수집‧이용 및 제3자 제공에 동의하지 않을 경우 시설 이용에 제한이 있습니다');
                return;
              }
              document.getElementById('agreement-modal').remove();
              document.querySelector('.main-card:nth-of-type(2)').style.display = '';
            };
            document.getElementById('agreement-cancel').onclick = function() {
              document.getElementById('agreement-modal').remove();
              window.location.href = 'index.html';
            };
        }
        // 페이지 진입 시 동의 모달 먼저 띄우고, 동의 전까지 개인정보 입력 폼 숨김
        window.addEventListener('DOMContentLoaded', function() {
            const formCard = document.querySelector('.main-card:nth-of-type(2)');
            if (formCard) formCard.style.display = 'none';
            showAgreementModal();
        });

        // 전화번호 4자리 미입력 시 모달
        function showPhoneErrorModal() {
            let modal = document.createElement('div');
            modal.style.position = 'fixed';
            modal.style.left = 0;
            modal.style.top = 0;
            modal.style.width = '100vw';
            modal.style.height = '100vh';
            modal.style.background = 'rgba(0,0,0,0.35)';
            modal.style.display = 'flex';
            modal.style.alignItems = 'center';
            modal.style.justifyContent = 'center';
            modal.style.zIndex = 9999;
            modal.innerHTML = `<div style="background:#fff;padding:22px 18px;border-radius:14px;box-shadow:0 4px 24px #e74c3c22;font-size:1.05rem;font-weight:600;color:#e74c3c;text-align:center;min-width:180px;max-width:90vw;">
                전화번호 형식이 올바르지 않습니다.<br><br>
                <button style='margin-top:12px;padding:7px 22px;border-radius:10px;background:linear-gradient(90deg,#e74c3c,#c0392b);border:none;font-weight:700;font-size:1.01rem;color:#fff;cursor:pointer;' onclick='this.parentElement.parentElement.remove()'>확인</button>
            </div>`;
            document.body.appendChild(modal);
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }
    </script>
</body>
</html> 